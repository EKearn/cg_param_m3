Thanks for using cg_kmw. Latest version: https://github.com/cgkmw-durham/cg_param_m3

This version is associated with the following publication, in preparation:

[1] A. Gredelj, J. Roberts, E. Kearney, E.L. Barrett, N. Haywood, D. Sheffield, G. Hodges and M.A. Miller, Predicting aquatic toxicity of anionic hydrocarbon and perfluorinated surfactants using membrane-water partition coefficients from coarse-grained simulations

Previous versions were released with the following publications, where explanations of the methodology can be found:

[2] T.D. Potter, N. Haywood, A. Teixeria, G. Hodges, E.L. Barrett and M.A. Miller, Partitioning into Phophatidylcholine-Cholesterol Membreane: Lipsome Measurements, Coarse-Grained Simulations, and Implications for Bioaccumulation, Environ. Sci.: Processes Impacts, 2023, 25, 1082-1093, DOI: https://doi.org/10.1039/D3EM00081H 

[3] T.D. Potter, E.L. Barrett and M.A. Miller, Automated Coarse-Grained Mapping Algorithm for the Martini Force Field and Benchmarks for Membraneâ€“Water Partitioning, J. Chem. Theory Comput., 2021, 17, 5777-5791, https://doi.org/10.1021/acs.jctc.1c00322.

Major changes:
----- Inclusion of verbose mode to assist interpretation of results and debugging.
----- Switch to center of geometry mapping of bead coordinates.
----- Changes to spectral mapping algorithm: floats now allowed on the adjacency matrix, and a weighting function is imposed to avoid large values in matrix diagonalisations found for large, branched molecules.
----- Inclusion of Martini X beads. These are only automatically assigned in fluorinated molecule with more then 2 fluorines together, intended to capture behaviour of PFAS (poly/perfluoroalkyl substances).
----- Inclusion of new sulfonate parameterisation and ester bead assignment.
----- Additional bug fixes.

Verbose mode:
----- Lines 1553-1560.
----- Added parsing commands to increase code usability.
----- Added flag to print useful data throughout the codes execution.
----- Added flag to print labelled svg of the molecule being mapped.
----- Added flag to activate dimer "tuning" (subject of separate publication, in preparation).
----- Added help flag to advise on using parsing.

Center of geometry:
----- Lines 1002-1029, 1407-1439.
----- Added flags to select Center of Mass (COM) mapping. Center of Geometry (COG) mapping is default.
----- CoG mapping is now recommended by the Martini developers in P. C. T. Souza et al., Martini 3: a general purpose force field for coarse-grained molecular dynamics, Nature Methods, 2021, 18, 382-388
----- CoG mapping added, hydrogens included in determination of position, so this has a notable impact on bead coordinates as opposed to the previous COM mapping.

Spectral mapping:
----- Lines 122-144, 618.
----- Added function to scale spectral mapping algorithm dynamically. This reduces the variance in eigenvector magnitudes, avoiding precision errors in large, highly branched molecules.

Martini X beads for halogens:
----- Lines 75, 782-822, 937-941.
----- Included halogen bead log Kow values.
----- Added code to access halogen beads if >= 2 fluorines are in a bead.
----- Adds alternative charge bead assignment in the case of sulfonates or carboxylates with an adjacent bead with >= 2 fluorines.

Inclusion of new sulfonate parameteriasation and ester bead assignment:
----- Lines 83-86, 1444-1450
----- Added new assignments dereived for sulfonates in Ref [1] above. The ester bead assignements are derieved in a further publication (in preparation).

Misc Bug Fixes:
----- Line 478: Added '.split(".")[0]' to prevent crashes when identical manually-assigned groups are in a molecule.
----- Line 503-506: Added if statement checks to ensure identical manually-assigned groups are all counted independently in paramerisation.   
